.\" -*- mode: troff; coding: utf-8 -*-
.\" Automatically generated by Pod::Man 5.01 (Pod::Simple 3.43)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" \*(C` and \*(C' are quotes in nroff, nothing in troff, for use with C<>.
.ie n \{\
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\" ========================================================================
.\"
.IX Title "App::Yath::Converting 3"
.TH App::Yath::Converting 3 2023-10-03 "perl v5.38.0" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH NAME
App::Yath::Converting \- Things you may need to change in your tests before you can use yath.
.SH "NON-TAP FORMATTER"
.IX Header "NON-TAP FORMATTER"
By default yath tells any Test2 or Test::Builder tests to use
Test2::Formatter::Stream instead of Test2::Formatter::TAP. This is done
in order to make sure as much data as possible makes it to yath, TAP is a lossy
formater by comparison.
.PP
This is not normally a problem, but tests that do strange things with
STDERR/STDOUT, or try to intercept output from the regular TAP formatter can
have issues with this.
.SS SOLUTIONS
.IX Subsection "SOLUTIONS"
\fIHARNESS-NO-STREAM\fR
.IX Subsection "HARNESS-NO-STREAM"
.PP
You can add a harness directive to the top of offending tests that tell the
harness those specific tests should still use the TAP formatter.
.PP
.Vb 3
\&    #!/usr/bin/perl
\&    # HARNESS\-NO\-STREAM
\&    ...
.Ve
.PP
This directive can come after the \f(CW\*(C`#!\*(C'\fR line, and after use statements, but
must come BEFORE any empty lines or runtime statements.
.PP
\fI\-\-no\-stream\fR
.IX Subsection "--no-stream"
.PP
You can run yath with the \f(CW\*(C`\-\-no\-stream\*(C'\fR option, which will have tests default
to TAP. This is not recommended as TAP is lossy.
.SH "TESTS ARE RUN VIA FORK BY DEFAULT"
.IX Header "TESTS ARE RUN VIA FORK BY DEFAULT"
The default mode for yath is to preload a few things, then fork to spawn each
test. This is a complicated procedure, and it uses goto::file under the
hood. Sometimes you have tests that simply will not work this way, or tests
that verify specific libraries are not already loaded.
.SS SOLUTIONS
.IX Subsection "SOLUTIONS"
\fIHARNESS-NO-PRELOAD\fR
.IX Subsection "HARNESS-NO-PRELOAD"
.PP
You can use this harness directive inside your tests to tell yath not to fork,
but to instead launch a new perl process to run the test.
.PP
.Vb 3
\&    #!/usr/bin/perl
\&    # HARNESS\-NO\-PRELOAD
\&    ...
.Ve
.PP
\fI\-\-no\-fork\fR
.IX Subsection "--no-fork"
.PP
\fI\-\-no\-preload\fR
.IX Subsection "--no-preload"
.PP
Both these options tell yath not to preload+fork, but to run ALL tests in new
processes. This is slow, it is better to mark specific tests that have issues
in preload mode.
.SH SOURCE
.IX Header "SOURCE"
The source code repository for Test2\-Harness can be found at
\&\fIhttp://github.com/Test\-More/Test2\-Harness/\fR.
.SH MAINTAINERS
.IX Header "MAINTAINERS"
.IP "Chad Granum <exodist@cpan.org>" 4
.IX Item "Chad Granum <exodist@cpan.org>"
.SH AUTHORS
.IX Header "AUTHORS"
.PD 0
.IP "Chad Granum <exodist@cpan.org>" 4
.IX Item "Chad Granum <exodist@cpan.org>"
.PD
.SH COPYRIGHT
.IX Header "COPYRIGHT"
Copyright 2020 Chad Granum <exodist7@gmail.com>.
.PP
This program is free software; you can redistribute it and/or
modify it under the same terms as Perl itself.
.PP
See \fIhttp://dev.perl.org/licenses/\fR
